# ゲームルール

## 概要
- ボトルを投げて立たせるゲーム
- 成功するとコインがもらえる
- コインでガチャを回してボトルを集める

## ボトルフリップのルール

### 成功条件
以下の全てを満たした時に成功:
1. ボトルが地面に接触している
2. ボトルの傾きが**15度以内**
3. ボトルの速度が**しきい値以下**
4. 上記状態が**0.5秒以上**継続

### 失敗条件
以下のいずれかで失敗:
1. ボトルが倒れた状態で安定した
2. 判定タイムアウト（**10秒**）

### 物理パラメータ

| パラメータ | 値 | 説明 |
|-----------|-----|------|
| uprightThreshold | 15° | 直立判定の最大傾き |
| stableVelocityThreshold | 0.1 | 安定判定の速度しきい値 |
| stableTime | 0.5秒 | 必要な安定継続時間 |
| judgeTimeout | 10秒 | 判定タイムアウト |

---

## コインシステム

### 獲得
| 条件 | コイン |
|------|--------|
| 成功 | +50 |
| 失敗 | +0 |

※ ボトルのレアリティによる倍率（TODO）

### 消費
| アクション | コイン |
|-----------|--------|
| 単発ガチャ | -100 |
| 10連ガチャ | -900 |

---

## ガチャ確率

| レアリティ | 確率 | 表示 |
|-----------|------|------|
| コモン | 70% | ★ |
| アンコモン | 20% | ★★ |
| レア | 7% | ★★★ |
| スーパーレア | 2.5% | ★★★★ |
| ウルトラレア | 0.5% | ★★★★★ |

### 天井保証
- 10連ガチャでは最低1つ★★★以上確定

---

## コメントシステム

### 制限
- 最大文字数: **50文字**
- 投稿後のクールダウン: なし（投げごとに1回）

### 表示
- 母艦アプリに一定時間表示
- プレイヤー名と共に表示

---

## 接続・通信

### 接続状態
- 接続中: 投げ可能
- 切断: 投げ不可、再接続を促す

### タイムアウト
- 投げ結果: 10秒以内に返答がなければエラー
